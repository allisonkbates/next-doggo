{"ast":null,"code":"var _jsxFileName = \"/Users/allison.mazzetti/Documents/next-doggo/pages/index.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Layout from '../components/Layout';\nimport Link from 'next/link';\nimport fetch from 'isomorphic-unfetch';\nconst key = 'XB3vY8VxHRq2gORl6Vs2VspjBmFj26eG1WD91SU09nWCQonR6L';\nconst secret = '3bPz0lHF0NqGt7OHuJeeWhgTLizUqcHqVuFJUGmL'; // dog filters\n\nconst size = 'large';\nconst type = 'dog';\nconst status = 'adoptable'; // token vars\n\nvar token, tokenType, expires; //renders\n\nconst Index = props => __jsx(Layout, {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 16,\n    columnNumber: 3\n  }\n}, __jsx(\"h1\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 17,\n    columnNumber: 2\n  }\n}, \"Doggos\"), __jsx(\"ul\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 18,\n    columnNumber: 6\n  }\n}, props.doggos.map(doggo => __jsx(\"li\", {\n  key: doggo.id,\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 20,\n    columnNumber: 9\n  }\n}, __jsx(Link, {\n  href: \"/p/[id]\",\n  as: `/p/${doggo.id}`,\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 21,\n    columnNumber: 11\n  }\n}, __jsx(\"a\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 22,\n    columnNumber: 13\n  }\n}, doggo.name))))));\n\nvar getDoggos = function () {\n  return fetch('https://api.petfinder.com/v2/animals?size=' + size + '&type=' + type + '&status=' + status, {\n    headers: {\n      'Authorization': tokenType + ' ' + token,\n      'Content-Type': 'application/x-www-form-urlencoded'\n    }\n  }).then(function (response) {\n    return response.json();\n  }).then(function (data) {\n    console.log('doggos', data);\n  }).catch(function (err) {\n    console.log('something went wrong...', err);\n  });\n};\n\nvar getOAuth = function () {\n  return fetch('https://api.petfinder.com/v2/oauth2/token', {\n    method: 'POST',\n    body: 'grant_type=client_credentials&client_id=' + key + '&client_secret=' + secret,\n    headers: {\n      'Content-Type': 'application/x-www-form-urlencoded'\n    }\n  }).then(function (response) {\n    return response.json();\n  }).then(function (data) {\n    console.log('token', data);\n    token = data.access_token;\n    tokenType = data.token_type;\n    expires = new Date().getTime() + data.expires_in * 1000;\n  }).catch(function (err) {\n    console.log('something went wrong...', err);\n  });\n};\n\nvar callDoggos = function () {\n  var now = new Date();\n\n  if (!expires || expires - now.getTime() < 1) {\n    console.log('new call');\n    getOAuth().then(function () {\n      getDoggos();\n    });\n    return;\n  }\n\n  console.log('from cache');\n  getDoggos();\n};\n\nIndex.getInitialProps = async function () {\n  const data = await callDoggos();\n  const doggos = data.animals;\n  console.log(doggos);\n  return {\n    doggos: doggos.map(entry => entry.doggo)\n  };\n};\n\nexport default Index;","map":{"version":3,"sources":["/Users/allison.mazzetti/Documents/next-doggo/pages/index.js"],"names":["Layout","Link","fetch","key","secret","size","type","status","token","tokenType","expires","Index","props","doggos","map","doggo","id","name","getDoggos","headers","then","response","json","data","console","log","catch","err","getOAuth","method","body","access_token","token_type","Date","getTime","expires_in","callDoggos","now","getInitialProps","animals","entry"],"mappings":"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","sourcesContent":["import Layout from '../components/Layout';\nimport Link from 'next/link';\nimport fetch from 'isomorphic-unfetch';\n\nconst key = 'XB3vY8VxHRq2gORl6Vs2VspjBmFj26eG1WD91SU09nWCQonR6L';\nconst secret = '3bPz0lHF0NqGt7OHuJeeWhgTLizUqcHqVuFJUGmL';\n// dog filters\nconst size = 'large';\nconst type = 'dog';\nconst status = 'adoptable';\n// token vars\nvar token, tokenType, expires;\n\n//renders\nconst Index = props => (\n  <Layout>\n\t<h1>Doggos</h1>\n\t    <ul>\n      {props.doggos.map(doggo => (\n        <li key={doggo.id}>\n          <Link href=\"/p/[id]\" as={`/p/${doggo.id}`}>\n            <a>{doggo.name}</a>\n          </Link>\n        </li>\n      ))}\n    </ul>\n  </Layout>\n);\n\nvar getDoggos = function() {\n  return fetch('https://api.petfinder.com/v2/animals?size=' + size + '&type=' + type + '&status=' + status, {\n\theaders: {\n\t  'Authorization': tokenType + ' ' + token,\n\t  'Content-Type': 'application/x-www-form-urlencoded'\n\t}\n  }).then(function(response) {\n\treturn response.json();\n  }).then(function(data) {\n\tconsole.log('doggos', data);\n  }).catch(function(err){\n\tconsole.log('something went wrong...', err);\n  });\n};\n\nvar getOAuth = function() {\n  return fetch('https://api.petfinder.com/v2/oauth2/token', {\n  method: 'POST',\n  body: 'grant_type=client_credentials&client_id=' + key + '&client_secret=' + secret,\n  headers: {\n\t'Content-Type': 'application/x-www-form-urlencoded'\n\t}\n  }).then(function(response) {\n\treturn response.json();\n  }).then(function(data) {\n\tconsole.log('token', data);\n\ttoken = data.access_token;\n\ttokenType = data.token_type;\n\texpires = new Date().getTime() + (data.expires_in * 1000);\n  }).catch(function(err) {\n\tconsole.log('something went wrong...', err);\n  });\n};  \n\nvar callDoggos = function() {\n\tvar now = new Date();\n\tif (!expires || expires - now.getTime() < 1) {\n\t\tconsole.log('new call');\n\t\tgetOAuth().then(function() {\n\t\t\tgetDoggos();\n\t\t});\n\t\treturn;\n\t}\n\t\tconsole.log('from cache');\n\t  \tgetDoggos();\n};\n\n\nIndex.getInitialProps = async function() {\n  const data = await callDoggos();\n  const doggos = data.animals;\n\n  console.log(doggos);\n\n  return {\n\tdoggos: doggos.map(entry => entry.doggo)\n  };\n};\n\nexport default Index;"]},"metadata":{},"sourceType":"module"}