{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/allison.mazzetti/Documents/next-doggo/pages/index.js\";\n\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Layout from '../components/Layout';\nimport Link from 'next/link';\nimport fetch from 'isomorphic-unfetch';\nvar key = 'XB3vY8VxHRq2gORl6Vs2VspjBmFj26eG1WD91SU09nWCQonR6L';\nvar secret = 'RFxJiWNYX6ENjRQ70gOSkpGhdput9tkDsMcH3ocN'; // dog filters\n\nvar size = 'large';\nvar type = 'dog';\nvar status = 'adoptable'; // token vars\n\nvar token, tokenType, expires; //renders\n\nvar Index = function Index(props) {\n  return __jsx(Layout, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 16,\n      columnNumber: 3\n    }\n  }, __jsx(\"h1\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 17,\n      columnNumber: 5\n    }\n  }, \"Doggos\"), __jsx(\"ul\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 18,\n      columnNumber: 5\n    }\n  }, props.doggos.map(function (doggo) {\n    return __jsx(\"li\", {\n      key: doggo.id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 20,\n        columnNumber: 9\n      }\n    }, __jsx(Link, {\n      href: \"/p/[id]\",\n      as: \"/p/\".concat(doggo.id),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 11\n      }\n    }, __jsx(\"a\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 13\n      }\n    }, doggo.name)));\n  })));\n};\n\nvar getDoggos = function getDoggos() {\n  return fetch('https://api.petfinder.com/v2/animals?size=' + size + '&type=' + type + '&status=' + status, {\n    headers: {\n      'Authorization': tokenType + ' ' + token,\n      'Content-Type': 'application/x-www-form-urlencoded'\n    }\n  }).then(function (response) {\n    return response.json();\n  }).then(function (data) {\n    console.log('doggos', data);\n  })[\"catch\"](function (err) {\n    console.log('something went wrong...', err);\n  });\n};\n\nvar getOAuth = function getOAuth() {\n  return fetch('https://api.petfinder.com/v2/oauth2/token', {\n    method: 'POST',\n    body: 'grant_type=client_credentials&client_id=' + key + '&client_secret=' + secret,\n    headers: {\n      'Content-Type': 'application/x-www-form-urlencoded'\n    }\n  }).then(function (response) {\n    return response.json();\n  }).then(function (data) {\n    console.log('token', data);\n    token = data.access_token;\n    tokenType = data.token_type;\n    expires = new Date().getTime() + data.expires_in * 1000;\n  })[\"catch\"](function (err) {\n    console.log('something went wrong...', err);\n  });\n};\n\nvar callDoggos = function callDoggos() {\n  if (!expires || expires - new Date.getTime() < 1) {\n    console.log('new call');\n    getOAuth().then(function () {\n      getDoggos();\n    });\n    return;\n  }\n\n  console.log('from cache');\n  getDoggos();\n};\n\nIndex.getInitialProps = function _callee() {\n  var data;\n  return _regeneratorRuntime.async(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.next = 2;\n          return _regeneratorRuntime.awrap(callDoggos());\n\n        case 2:\n          data = _context.sent;\n          console.log(\"Show data fetched. Count: \".concat(data.length));\n          return _context.abrupt(\"return\", {\n            doggos: data.map(function (entry) {\n              return entry.doggo;\n            })\n          });\n\n        case 5:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};\n\nexport default Index;","map":{"version":3,"sources":["/Users/allison.mazzetti/Documents/next-doggo/pages/index.js"],"names":["Layout","Link","fetch","key","secret","size","type","status","token","tokenType","expires","Index","props","doggos","map","doggo","id","name","getDoggos","headers","then","response","json","data","console","log","err","getOAuth","method","body","access_token","token_type","Date","getTime","expires_in","callDoggos","getInitialProps","length","entry"],"mappings":"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","sourcesContent":["import Layout from '../components/Layout';\nimport Link from 'next/link';\nimport fetch from 'isomorphic-unfetch';\n\nconst key = 'XB3vY8VxHRq2gORl6Vs2VspjBmFj26eG1WD91SU09nWCQonR6L';\nconst secret = 'RFxJiWNYX6ENjRQ70gOSkpGhdput9tkDsMcH3ocN';\n// dog filters\nconst size = 'large';\nconst type = 'dog';\nconst status = 'adoptable';\n// token vars\nvar token, tokenType, expires;\n\n//renders\nconst Index = props => (\n  <Layout>\n    <h1>Doggos</h1>\n    <ul>\n      {props.doggos.map(doggo => (\n        <li key={doggo.id}>\n          <Link href=\"/p/[id]\" as={`/p/${doggo.id}`}>\n            <a>{doggo.name}</a>\n          </Link>\n        </li>\n      ))}\n    </ul>\n  </Layout>\n);\n\nvar getDoggos = function() {\n  return fetch('https://api.petfinder.com/v2/animals?size=' + size + '&type=' + type + '&status=' + status, {\n    headers: {\n      'Authorization': tokenType + ' ' + token,\n      'Content-Type': 'application/x-www-form-urlencoded'\n    }\n  }).then(function(response) {\n    return response.json();\n  }).then(function(data) {\n    console.log('doggos', data);\n  }).catch(function(err){\n    console.log('something went wrong...', err);\n  });\n};\n\nvar getOAuth = function() {\n  return fetch('https://api.petfinder.com/v2/oauth2/token', {\n  method: 'POST',\n  body: 'grant_type=client_credentials&client_id=' + key + '&client_secret=' + secret,\n  headers: {\n    'Content-Type': 'application/x-www-form-urlencoded'\n    }\n  }).then(function(response) {\n    return response.json();\n  }).then(function(data) {\n    console.log('token', data);\n    token = data.access_token;\n    tokenType = data.token_type;\n    expires = new Date().getTime() + (data.expires_in * 1000);\n  }).catch(function(err) {\n    console.log('something went wrong...', err);\n  });\n};  \n\nvar callDoggos = function() {\n  if (!expires || expires-new Date.getTime() < 1) {\n    console.log('new call');\n    getOAuth().then(function() {\n      getDoggos();\n    });\n    return;\n  }\n  console.log('from cache');\n  getDoggos();\n};\n\n\nIndex.getInitialProps = async function() {\n  const data = await callDoggos();\n\n  console.log(`Show data fetched. Count: ${data.length}`);\n\n  return {\n    doggos: data.map(entry => entry.doggo)\n  };\n};\n\nexport default Index;"]},"metadata":{},"sourceType":"module"}